select GROUP_NUMBER, name, type, total_mb, free_mb, required_mirror_free_mb, usable_file_mb, round(100*(total_mb-(FREE_MB - REQUIRED_MIRROR_FREE_MB))/total_mb,0) AS used_pct from v$asm_diskgroup order by group_number;
select i.instance_name instance, dg.name as diskgroup, st.volume_name as volume, st.reads, st.writes, st.read_errs, st.write_errs, st.read_time, st.write_time, st.bytes_read, st.bytes_written from gv$asm_volume_stat st join gv$instance i on i.inst_id=st.inst_id join gv$asm_diskgroup dg on dg.group_number=st.group_number order by instance_name;
select name, db_unique_name, created, log_mode, database_role, guard_status from v$database;
select instance_name||'   |   '||host_name||'   |   '||to_char(startup_time, 'yyyy/mm/dd hh24:mi:ss') ||'   |   '||status||'   |   '||instance_role from gv$instance;
select * from v$version;
select rpad(i.INSTANCE_NAME, 16, ' ')||'|'||rpad(s.NAME, 30, ' ')||'|'||rpad(s.NETWORK_NAME, 30, ' ')||'|'||s.BLOCKED from gv$active_services s, gv$instance i where s.inst_id=i.inst_id and network_name is not null order by i.instance_name, s.name;
select round(total_size/1024,2) "TOTAL GB", round(system_size/1024,2) "SYSTEM GB", round(system_free/1024,2) "SYSTEM FREE GB", round(temp_size/1024,2) "TEMP GB", round(undo_size/1024,2) "UNDO GB", round(data_size/1024,2) "DATA GB", round(data_free/1024,2) "DATA FREE GB", pct_libre_utile "DATA PCT FREE" from (with cible as (select d.name||'\@'||i.host_name as env_name, to_char(sysdate, 'YYYY/MM/DD') as day from v$database d, v$instance i), ts_info as (select tablespace_name, decode(tablespace_name, 'SYSTEM', 'SYSTEM', 'SYSAUX', 'SYSTEM', contents) as contents_type from dba_tablespaces), ts_size as (select tablespace_name, sum(bytes) as size_b from dba_data_files group by tablespace_name union all select tablespace_name, sum(bytes) as size_b from dba_temp_files group by tablespace_name), ts_free as (select t.tablespace_name, sum(nvl(fs.bytes,0)) as size_b FROM dba_tablespaces t left outer join dba_free_space fs on t.tablespace_name = fs.tablespace_name group by t.tablespace_name), sum_size as (select round(sum(decode(ts_info.contents_type, 'PERMANENT', size_b, 0))/1024/1024,0) as data_size, round(sum(decode(ts_info.contents_type, 'TEMPORARY', size_b, 0))/1024/1024,0) as temp_size, round(sum(decode(ts_info.contents_type, 'UNDO', size_b, 0))/1024/1024,0) as undo_size, round(sum(decode(ts_info.contents_type, 'SYSTEM', size_b, 0))/1024/1024,0) as system_size, round(sum(size_b)/1024/1024,0) as total_size from ts_info natural join ts_size), sum_free as (select round(sum(decode(ts_info.contents_type, 'PERMANENT', size_b, 0))/1024/1024,0) as data_free, round(sum(decode(ts_info.contents_type, 'TEMPORARY', 0, 0))/1024/1024,0) as temp_free, round(sum(decode(ts_info.contents_type, 'UNDO', size_b, 0))/1024/1024,0) as undo_free, round(sum(decode(ts_info.contents_type, 'SYSTEM', size_b, 0))/1024/1024,0) as system_free, round(sum(size_b)/1024/1024,0) as total_free from ts_info natural join ts_free) select cible.env_name, cible.day, data_size, data_free, temp_size, temp_free, undo_size, undo_free, system_size, system_free, total_size, total_free, (system_size + data_size + undo_size + temp_size) as enveloppe_totale, (data_size) as enveloppe_utile, (data_size - data_free) as utilise_utile, (data_free) as libre_utile, round(100*(data_free) / (data_size),0) as pct_libre_utile from cible cross join sum_size cross join sum_free);
select tablespace_name, contents, extent_management, segment_space_management, bigfile from dba_tablespaces order by 1;
select a.TABLESPACE_NAME as NAME, nvl(sum(b.count_files),0) as NBFILES, nvl(round(sum(b.bytes)/1024/1024),0) as FILESIZE, nvl(round(sum(b.maxbytes)/1024/1024),0) as MAXSIZE, nvl(round(sum(b.bytes)/1024/1024),0) - nvl(round(sum(c.free_bytes)/1024/1024),0) as USED, round((nvl(round(sum(b.bytes)/1024/1024),0)-nvl(round(sum(c.free_bytes)/1024/1024),0))/nvl(round(sum(b.maxbytes)/1024/1024),1)*1000)/10 as PERCENTUSED from DBA_TABLESPACES a, (select TABLESPACE_NAME, sum(BYTES) bytes, count(*) count_files, sum(greatest(MAXBYTES,BYTES)) maxbytes from DBA_DATA_FILES group by TABLESPACE_NAME union all select TABLESPACE_NAME, sum(BYTES), count(*), sum(greatest(MAXBYTES,BYTES)) maxbytes from DBA_TEMP_FILES group by TABLESPACE_NAME) b, (select TABLESPACE_NAME, sum(BYTES) free_bytes from DBA_FREE_SPACE group by TABLESPACE_NAME union all select TABLESPACE_NAME, sum(BYTES_FREE) free_bytes from V$TEMP_SPACE_HEADER group by TABLESPACE_NAME ) c where a.TABLESPACE_NAME = b.TABLESPACE_NAME (+) and a.TABLESPACE_NAME = c.TABLESPACE_NAME (+) group by a.TABLESPACE_NAME, a.CONTENTS order by 6 Desc;
select rpad(tablespace_name, 20, ' ')||'|'||rpad(file_name, 50, ' ')||'|'||lpad(bytes/1024/1024, 10, ' ')||'|'||autoextensible||'|'||lpad(round(maxbytes/1024/1024), 10, ' ')||'|'||lpad(increment_by, 10, ' ') from dba_data_files order by tablespace_name, file_name;
select group#, members, bytes/1024/1024 "MB" from v$log order by group#;
select rpad(group#, 10, ' ')||'|'||rpad(member, 50, ' ')||'|'||type||'|'||status from v$logfile where type='ONLINE' order by group#, member;
select 'test ici'||78999||'OK' from dual;
